<VirtualHost *:8443>
    ServerName  odrs-dev.gnome.org 
    DocumentRoot /opt/app-root/src

    SSLEngine on
    SSLProtocol All -SSLv2 -SSLv3
    SSLCertificateFile /var/serving-cert/tls.crt
    SSLCertificateKeyFile /var/serving-cert/tls.key

    Alias /static/ /opt/app-root/src/odrs/static
    Alias /1.0/reviews/api/ratings /opt/app-root/src/odrs/static/ratings.json

    WSGIDaemonProcess odrs.gnome.org processes=10 threads=15 maximum-requests=100
    WSGIProcessGroup odrs.gnome.org

    WSGIScriptAlias / /opt/app-root/src/wsgi-scripts/odrs.wsgi

    SetEnv ODRS_REVIEWS_SECRET %{ENV:ODRS_REVIEWS_SECRET}
    SetEnv SQLALCHEMY_DATABASE_URI %{ENV:SQLALCHEMY_DATABASE_URI}

    <Location /static/>
        ExpiresActive On
        ExpiresByType image/png "access plus 1 week"
        ExpiresByType application/javascript "access plus 1 week"
        ExpiresByType text/javascript "access plus 1 week"
        ExpiresByType text/css "access plus 1 day"
        Header set Cache-Control "public"
    </Location>
</VirtualHost>

<Directory "/opt/app-root/src/odrs/static">
  AllowOverride None

  Require all granted
</Directory>

<Directory "/opt/app-root/src/wsgi-scripts">
  Require all granted
</Directory>
